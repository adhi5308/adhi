<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cart</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
  .cart-item { background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between; }
  .cart-info { display: flex; align-items: center; }
  .cart-item img { width: 80px; height: 80px; object-fit: cover; margin-right: 15px; border-radius: 5px; }
  .cart-item h3 { margin: 0; }
  input[type="number"] { width: 50px; padding: 5px; margin-right: 10px; }
  button { padding: 5px 10px; background: red; color: white; border: none; border-radius: 5px; cursor: pointer; }
  .proceed-btn { display: block; text-align: center; background: green; color: white; padding: 10px; margin-top: 20px; text-decoration: none; border-radius: 5px; font-weight: bold; }
</style>
</head>
<body>

<h1>Your Cart</h1>
<div id="cartContainer"></div>

<a href="payment.html" class="proceed-btn">Proceed to Pay</a>

<script>
  if (!localStorage.getItem("loggedInUser")) {
  alert("Please login to view your cart.");
  window.location.href = "index.html";
}

function loadCart() {
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  let container = document.getElementById('cartContainer');
  container.innerHTML = '';

  if (cart.length === 0) {
    container.innerHTML = '<p>Your cart is empty.</p>';
    return;
  }

  cart.forEach((item, index) => {
    let itemTotal = item.price * (item.qty || 1);
    container.innerHTML += `
      <div class="cart-item">
        <div class="cart-info">
          <img src="${item.image}" alt="${item.name}">
          <div>
            <h3>${item.name}</h3>
            <p>${item.description}</p>
            <p>Price: Rs.${item.price}/kg</p>
            <p>Total: Rs.<span id="total-${index}">${itemTotal}</span></p>
            <input type="number" min="1" value="${item.qty || 1}" onchange="updateQty(${index}, this.value)">
          </div>
        </div>
        <button onclick="removeFromCart(${index})">Remove</button>
      </div>
    `;
  });
}


function updateQty(index, qty) {
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  cart[index].qty = parseInt(qty);
  localStorage.setItem('cart', JSON.stringify(cart));

  document.getElementById(`total-${index}`).innerText = cart[index].price * cart[index].qty;
}

function removeFromCart(index) {
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  cart.splice(index, 1);
  localStorage.setItem('cart', JSON.stringify(cart));
  loadCart();
}

loadCart();
</script>

</body>
</html>
